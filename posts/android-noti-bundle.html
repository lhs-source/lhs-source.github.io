<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/svg+xml" href="/vite.svg">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>안드로이드 노티피케이션 번들 데이터 최신화 Android Notification Bundle Data</title>
    <script type="module" crossorigin="" src="/assets/app-f2535a55.js"></script>
    <link rel="stylesheet" href="/assets/index-e7b8570c.css">
  <link rel="modulepreload" crossorigin="" href="/assets/posts-c06c2dea.js"><link rel="stylesheet" href="/assets/posts-01730728.css"><link rel="modulepreload" crossorigin="" href="/assets/android-noti-bundle-4e7e3d84.js"><meta name="description" content="안드로이드 노티피케이션을 터치해 액티비티를 진입할 때 onCreate 에서 전달받는 데이터가 원치 않는 값으로 들어온다. 해결 방법을 찾아보자."><meta property="og:title" content="안드로이드 노티피케이션 번들 데이터 최신화 Android Notification Bundle Data"></head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="post-index-wrapper" data-v-2b6ea3cb=""><header class="header-wrapper" data-v-2b6ea3cb="" data-v-758091e7=""><div class="header-row" data-v-758091e7=""><div class="to-home" data-v-758091e7=""><div class="profile-frame" data-v-758091e7=""><img class="crow-profile" src="/assets/Dream_Background-969973a4.jpg" data-v-758091e7=""></div><span data-v-758091e7="">내가 만든 블로그~</span></div><div class="menu-list" data-v-758091e7=""><!--[--><div class="menu" data-v-758091e7="">더미 메뉴1</div><div class="menu" data-v-758091e7="">더미 메뉴2</div><!--]--></div></div><div class="header-row slot" data-v-758091e7=""><!--[--><div class="header-sub-post" data-v-2b6ea3cb="" data-v-51f5ba86=""><div class="menu" data-v-51f5ba86="">📻포스팅 목록</div><div class="menu" data-v-51f5ba86="">📚목차</div></div><!--]--></div></header><aside class="" data-v-2b6ea3cb="" data-v-1d581cda=""><div class="post-list" data-v-1d581cda=""><!--[--><!--]--></div></aside><main data-v-2b6ea3cb=""><div class="markdown-body" data-v-2b6ea3cb=""><p></p><div class="table-of-contents"><ul><li><a href="#%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C-%EB%85%B8%ED%8B%B0%ED%94%BC%EC%BC%80%EC%9D%B4%EC%85%98-%EB%B2%88%EB%93%A4-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B5%9C%EC%8B%A0%ED%99%94-android-notification-bundle-data">안드로이드 노티피케이션 번들 데이터 최신화 Android Notification Bundle Data</a></li></ul></div><p></p><h1 id="%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C-%EB%85%B8%ED%8B%B0%ED%94%BC%EC%BC%80%EC%9D%B4%EC%85%98-%EB%B2%88%EB%93%A4-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B5%9C%EC%8B%A0%ED%99%94-android-notification-bundle-data" tabindex="-1">안드로이드 노티피케이션 번들 데이터 최신화 Android Notification Bundle Data</h1><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">sendNoti</span><span class="token punctuation">(</span>title<span class="token operator">:</span> String<span class="token punctuation">,</span> message<span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token keyword">data</span><span class="token operator">:</span> Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">val</span> intent <span class="token operator">=</span> <span class="token function">Intent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> MainActivity<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{</span>  
        flags <span class="token operator">=</span> Intent<span class="token punctuation">.</span>FLAG_ACTIVITY_CLEAR_TASK <span class="token operator">or</span> Intent<span class="token punctuation">.</span>FLAG_ACTIVITY_NEW_TASK <span class="token operator">or</span> Intent<span class="token punctuation">.</span>FLAG_ACTIVITY_SINGLE_TOP
        <span class="token keyword">data</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"key"</span></span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">let</span> <span class="token punctuation">{</span>value <span class="token operator">-&gt;</span> 
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"key"</span></span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">val</span> pendingIntent <span class="token operator">=</span> PendingIntent<span class="token punctuation">.</span><span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> intent<span class="token punctuation">,</span> FLAG_MUTABLE<span class="token punctuation">)</span> 
    <span class="token keyword">val</span> notificationBuilder <span class="token operator">=</span> NotificationCompat<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> channelId<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setContentIntent</span><span class="token punctuation">(</span>pendingIntent<span class="token punctuation">)</span>  
<span class="token punctuation">}</span>
</code></pre><p>이렇게 넣어주었는데, 노티를 띄울 때는 <code class="">intent Bundle[{key=newvalue}]</code> 로 표시되고 onCreate 에서 노티 데이터를 받았을 때는 <code class="">bundle Bundle[{key=oldvalue}]</code> 로 표시된다.</p><p>가장 최근으로 띄운 노티의 데이터가 아닌, 이젠 노티의 데이터를 사용하는 듯 하다.</p><p><a href="https://stackoverflow.com/a/3140497">Android keeps caching my intents Extras, how to declare a pending intent that keeps fresh extras? - Stack Overflow</a></p><p>가장 최신의 노티 데이터를 항상 덮어 쓰게끔 하면 된다!</p><ol><li><code class="">FLAG_UPDATE_CURRENT</code> 플래그를 사용하고</li><li><code class="">requestCode</code> 를 0 고정 값이 아니라 유니크한 값으로 지정해주면 된다.</li></ol><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> pendingIntent <span class="token operator">=</span> PendingIntent<span class="token punctuation">.</span><span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> intent<span class="token punctuation">,</span> FLAG_MUTABLE<span class="token punctuation">)</span>
</code></pre><p>우선은 별다른 규칙 없이 현재 타임스탬프를 지정해주니까, 내가 넣어준 마지막 값으로 잘 들어온다.</p></div><div class="new-table-of-contents" data-v-2b6ea3cb=""></div></main><footer data-v-2b6ea3cb="">TO BE FOOTER</footer></div></div></div>
<script>window.__INITIAL_STATE__="{\"pinia\":{\"post\":{\"postList\":[],\"currentUrl\":\"\"}}}"</script>
    
  

</body></html>